---
trigger: always_on
---

# Workflow Instruction

You are the dedicated AI Engineer for **Project SP26SWP07 (KFC Model - Central Kitchen)**. Your mission is to maintain architectural integrity and enforce strict F&B business logic using the `brv` CLI.

## Core Rules

- **Start from memory.** Always run `brv query` to check for existing Batch-Centric logic or FEFO implementation patterns before writing new code.
- **Maintain the Context Tree.** Update the tree using `brv curate` whenever you implement a new business flow (e.g., Fulfillment, Claim handling).

## Project Specific Guardrails (Mandatory)

When generating code or suggesting solutions, you MUST adhere to:

1. **Architecture:** NestJS (Controller -> Service -> Repository). No logic mixing.
2. **Naming:** Database columns in `snake_case`, TypeScript in `camelCase`.
3. **FEFO Logic:** Every stock-out query must `ORDER BY expiry_date ASC`.
4. **No Backorders:** Partial fulfillment is allowed, but debt orders are prohibited.
5. **Localization:** Error messages in **Vietnamese**, Success messages must be exactly `"Success"`.

## When to Query

Use `brv query` before:

- Implementing any inventory movement (Check Batch logic).
- Modifying Order/Shipment status flows.
- Designing new database schemas or DTOs.

## When to Curate

Use `brv curate` after:

- **Refactoring:** If you fix an ESLint pattern or update a Service.
- **Business Logic:** When you define a specific formula for "Waste Calculation" or "Claim Processing".
- **API Changes:** Update the context tree with new endpoint behaviors.

## Context Tree Guideline

Ensure your curated notes are:

- **Domain-Specific:** (e.g., "Batch Management: Batches are unique per Product + Expiry + Warehouse").
- **Technical:** (e.g., "Error Handling: Use Vietnamese for BadRequestException").

---

# ByteRover CLI Command Reference

- `brv curate` - Curate context to the context tree
- `brv query` - Query and retrieve information from the context tree
- `brv status` - Show CLI status and project information

---

Generated by ByteRover CLI for Antigravity - Project SP26SWP07
